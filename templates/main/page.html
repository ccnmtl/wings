{% extends 'base.html' %}
{% load render %}
{% load smartif %}
{% load random_image %}

{% block js %}
{% for block in section.pageblock_set.all %}
{% renderjs block %}
{% endfor %}


{%comment %}
	

    Make the page template as follows:
    For most pages there is a decoration image at the top of the page
    and an image at the bottom of the page.
    When there is an image or video block specifically assigned to the page
    these decorations are NOT SHOWN.
    These decorations take the following form:
    They are given a CSS style at random between A and B. (Liz will later make them float left and right.)
    The actual image files to display are chosen from 4 pools of images: viz: top A, top B, bottom A, bottom B. As much of this is possible should take place in CSS.

{%endcomment %}

{% if needs_submit %}
    <!-- TODO: use local jquery -->
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js" type="text/javascript" ></script> 

    <script language = "javascript">    
        function submit_when_changed(thing) {
            jQuery('#submit_to_self_form').submit()
        }
    
        function connect_forms () {
            jQuery('input[type="text"]') .blur(submit_when_changed);
            jQuery('input[type="text"]') .change(submit_when_changed);
            jQuery('input[type="radio"]').blur(submit_when_changed);
            jQuery('input[type="radio"]').change(submit_when_changed);
        }
        jQuery (connect_forms)
    </script>
{%endif%}

{% endblock %}

{% block css %}
{% for block in section.pageblock_set.all %}
{% rendercss block %}
{% endfor %}
{% endblock %}


{% block title %}{{section.label}}{% endblock %}

{% block sidenav %}
        <!-- ###### Secondary Navigation ###### -->
    {% if not user.part%}
        <div id="secondary_navigation">
                <div id="fadetop"></div>
                <div class="block">
                  {% if module.get_children %}
                        <h3>Sections</h3>
                        {% include "main/menu.html" %}
                  {% endif %}
                </div><!-- div id="block" -->
                <div id="fadebottom"></div>
        </div><!-- div id="secondary_navigation" -->
    {%endif %}
{% endblock %}



{% block content %}
<h3>{{section.label}}</h3>


{% if show_decorations %}
    <img class="decoration_image_{{'12'|make_list|random}}"  src = '{% random_image "site_media/img/decoration_images" %}' />
    </div>
{% endif %}

{% if messages %}
    <ul class="messages">
        {% for message in messages %}
            <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
        {% endfor %}
    </ul>
{% endif %}


{% if needs_submit %}
<form id="submit_to_self_form" action="." method="post">
{% endif %}


{% for block in section.pageblock_set.all %}
    {% if not block.block.is_help_block %}
        {% if block.label %}<h3>{{block.label}}</h3>{% endif %}
        {% render block %}
    {%endif %}
{% endfor %}


{% if needs_submit %}
</form>
{% endif %}

{% endblock %}
<br />

{% block content-nav %}

<div class="content-nav">
    <!-- Django messages go here-- e.g. "Please finish all quiz answers before continuing."-->
{% if section.get_previous %}
<a href="{{section.get_previous.get_absolute_url}}" id="previous">« {{section.get_previous.label}}</a>
{% endif %}



{% if section.get_next %}
    {% with section.get_next as next_section %}
        <a href="{{section.get_next.get_absolute_url}}" id="next">{{section.get_next.label}} »</a>
    {% endwith %}
{% endif %}

{%comment %}
    {% if section.get_help %}
    <a href="{{section.get_help.get_absolute_url}}" id="help">« {{section.get_help.label}}</a>
    {% endif %}
{%endcomment %}

{%comment %}
    <!-- this is liz' help button-->
    <a href="#" id="help">Help!</a>
{%endcomment %}


{% for block in section.pageblock_set.all %}
    {% if block.block.is_help_block %}
        {% render block %}
    {%endif %}
{% endfor %}



{% if section.show_decorations %}
<div id ="decoration_2" class = "decoration_image">
    <img source ="" />
</div>
{%endif %}
</div><!-- div id="content-nav" -->
{% endblock %}
